(self["webpackJsonp_proactiveServiceSaas"]=self["webpackJsonp_proactiveServiceSaas"]||[]).push([[139],{36852:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",[e._v("暂无对应的弹窗组件")])},l=[],o={},i=o,n=r(1001),s=(0,n.Z)(i,a,l,!1,null,null,null),c=s.exports},43647:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"60%",margin:"20px auto"}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("div",[t("el-form-item",{attrs:{label:"技能名称",prop:"skillName"}},[t("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.ruleForm.skillName,callback:function(t){e.$set(e.ruleForm,"skillName",t)},expression:"ruleForm.skillName"}})],1),t("el-form-item",{attrs:{label:"启动动作",prop:"startAction"}},[t("el-select",{attrs:{placeholder:"请选择启动动作"},on:{change:e.handleStartActionChange},model:{value:e.ruleForm.startAction,callback:function(t){e.$set(e.ruleForm,"startAction",t)},expression:"ruleForm.startAction"}},[t("el-option",{attrs:{label:"activity",value:100001}}),t("el-option",{attrs:{label:"broadcast",value:100002}}),t("el-option",{attrs:{label:"service",value:100003}})],1)],1),t("el-form-item",{attrs:{label:"启动方式",prop:"startMethod"}},[t("el-select",{attrs:{placeholder:"请选择启动方式"},on:{change:e.handleStartMethodChange},model:{value:e.ruleForm.startMethod,callback:function(t){e.$set(e.ruleForm,"startMethod",t)},expression:"ruleForm.startMethod"}},[t("el-option",{attrs:{label:"uri",value:200001}}),t("el-option",{attrs:{label:"action",value:200002}}),t("el-option",{attrs:{label:"className",value:200003}})],1)],1),100002!==e.ruleForm.startAction&200001!==e.ruleForm.startMethod||""===e.ruleForm.startAction?t("div",[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showAppPkg,expression:"showAppPkg"}],attrs:{label:"应用包名",prop:"appPkg"}},[t("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.ruleForm.appPkg,callback:function(t){e.$set(e.ruleForm,"appPkg",t)},expression:"ruleForm.appPkg"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showAppVer,expression:"showAppVer"}],attrs:{label:"应用版本号",prop:"appVer"}},[t("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.ruleForm.appVer,callback:function(t){e.$set(e.ruleForm,"appVer",t)},expression:"ruleForm.appVer"}})],1)],1):e._e(),t("el-form-item",{attrs:{label:"启动参数",prop:"startParam"}},[t("el-input",{attrs:{maxlength:"200","show-word-limit":""},model:{value:e.ruleForm.startParam,callback:function(t){e.$set(e.ruleForm,"startParam",t)},expression:"ruleForm.startParam"}})],1),t("el-form-item",{attrs:{label:"拓展参数",prop:"extendParam"}},[e._l(e.ruleForm.extendParam,(function(r,a){return t("div",{key:a+"item",staticStyle:{margin:"5px 0"}},[t("el-input",{staticStyle:{width:"calc(50% - 5px)","margin-right":"10px"},attrs:{placeholder:"请填写key",maxlength:"50","show-word-limit":""},model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"item.key"}}),t("el-input",{staticStyle:{width:"calc(50% - 5px)"},attrs:{placeholder:"请填写value",maxlength:"50","show-word-limit":""},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"item.value"}})],1)})),t("div",{staticClass:"addextendParamMapping",on:{click:function(t){return e.addextendParam(e.ruleForm.extendParam)}}},[e._v(" + 添加参数 ")])],2),t("el-form-item",{attrs:{label:"扩展参数映射",prop:"extendParamMapping"}},[e._l(e.ruleForm.extendParamMapping,(function(r,a){return t("div",{key:a+"item",staticStyle:{margin:"5px 0"}},[t("el-input",{staticStyle:{width:"calc(50% - 25px)"},attrs:{maxlength:"50","show-word-limit":"",placeholder:"请填写技能key"},model:{value:r.skillKey,callback:function(t){e.$set(r,"skillKey",t)},expression:"item.skillKey"}}),t("div",{staticStyle:{display:"inline-block",width:"50px","text-align":"center"}},[e._v("对应")]),t("el-input",{staticStyle:{width:"calc(50% - 25px)"},attrs:{maxlength:"50","show-word-limit":"",placeholder:"请填写事件key"},model:{value:r.eventKey,callback:function(t){e.$set(r,"eventKey",t)},expression:"item.eventKey"}})],1)})),t("div",{staticClass:"addextendParamMapping",on:{click:function(t){return e.addextendParamMapping(e.ruleForm.extendParamMapping)}}},[e._v(" + 添加参数 ")])],2),t("el-form-item",{attrs:{label:"入参",prop:"extendParamThird"}},[e._l(e.ruleForm.extendParamThird,(function(r,a){return t("div",{key:a+"item",staticStyle:{margin:"5px 0"}},[t("el-input",{staticStyle:{width:"calc(50% - 50px)","margin-right":"10px"},attrs:{maxlength:"50","show-word-limit":"",placeholder:"请填写参数别名"},model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"item.key"}}),t("el-input",{staticStyle:{width:"calc(50% - 50px)","margin-right":"10px"},attrs:{maxlength:"50","show-word-limit":"",placeholder:"请填写code"},model:{value:r.name,callback:function(t){e.$set(r,"name",t)},expression:"item.name"}}),t("el-select",{staticStyle:{width:"80px"},attrs:{placeholder:"请选择类型"},model:{value:r.dataType,callback:function(t){e.$set(r,"dataType",t)},expression:"item.dataType"}},[t("el-option",{attrs:{label:"数值",value:1}}),t("el-option",{attrs:{label:"字符",value:2}})],1)],1)})),t("div",{staticClass:"addextendParamMapping",on:{click:function(t){return e.addextendParamThird(e.ruleForm.extendParamThird)}}},[e._v(" + 添加参数 ")])],2),t("el-form-item",{attrs:{label:"技能描述",prop:"skillDesc"}},[t("el-input",{attrs:{type:"textarea",maxlength:"200","show-word-limit":""},model:{value:e.ruleForm.skillDesc,callback:function(t){e.$set(e.ruleForm,"skillDesc",t)},expression:"ruleForm.skillDesc"}})],1),t("el-form-item",{attrs:{label:"是否做异常处理",prop:"errorActionFlag"}},[t("el-radio-group",{on:{input:e.addErrorActionInfo},model:{value:e.ruleForm.errorActionFlag,callback:function(t){e.$set(e.ruleForm,"errorActionFlag",t)},expression:"ruleForm.errorActionFlag"}},[t("el-radio",{attrs:{label:0}},[e._v("否")]),t("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1),e.ruleForm.errorActionFlag?t("div",[t("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm.errorActionInfo,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"启动动作",prop:"startAction"}},[t("el-select",{attrs:{placeholder:"请选择启动动作"},on:{change:e.handleErrorStartActionChange},model:{value:e.ruleForm.errorActionInfo.startAction,callback:function(t){e.$set(e.ruleForm.errorActionInfo,"startAction",t)},expression:"ruleForm.errorActionInfo.startAction"}},[t("el-option",{attrs:{label:"activity",value:100001}}),t("el-option",{attrs:{label:"broadcast",value:100002}}),t("el-option",{attrs:{label:"service",value:100003}})],1)],1),t("el-form-item",{attrs:{label:"启动方式",prop:"startMethod"}},[t("el-select",{attrs:{placeholder:"请选择启动方式"},on:{change:e.handleErrorStartMethodChange},model:{value:e.ruleForm.errorActionInfo.startMethod,callback:function(t){e.$set(e.ruleForm.errorActionInfo,"startMethod",t)},expression:"ruleForm.errorActionInfo.startMethod"}},[t("el-option",{attrs:{label:"uri",value:200001}}),t("el-option",{attrs:{label:"action",value:200002}}),t("el-option",{attrs:{label:"className",value:200003}})],1)],1),100002!==e.ruleForm.errorActionInfo.startAction&200001!==e.ruleForm.errorActionInfo.startMethod||""===e.ruleForm.errorActionInfo.startAction?t("div",[t("el-form-item",{attrs:{label:"应用包名",prop:"appPkg"}},[t("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.ruleForm.errorActionInfo.appPkg,callback:function(t){e.$set(e.ruleForm.errorActionInfo,"appPkg",t)},expression:"ruleForm.errorActionInfo.appPkg"}})],1),t("el-form-item",{attrs:{label:"应用版本号",prop:"appVer"}},[t("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.ruleForm.errorActionInfo.appVer,callback:function(t){e.$set(e.ruleForm.errorActionInfo,"appVer",t)},expression:"ruleForm.errorActionInfo.appVer"}})],1)],1):e._e(),t("el-form-item",{attrs:{label:"启动参数",prop:"startParam"}},[t("el-input",{attrs:{maxlength:"200","show-word-limit":""},model:{value:e.ruleForm.errorActionInfo.startParam,callback:function(t){e.$set(e.ruleForm.errorActionInfo,"startParam",t)},expression:"ruleForm.errorActionInfo.startParam"}})],1),t("el-form-item",{attrs:{label:"拓展参数",prop:"extendParam"}},[e._l(e.ruleForm.errorActionInfo.extendParam,(function(r,a){return t("div",{key:a+"item",staticStyle:{margin:"5px 0"}},[t("el-input",{staticStyle:{width:"calc(50% - 5px)","margin-right":"10px"},attrs:{placeholder:"请填写key",maxlength:"50","show-word-limit":""},model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"item.key"}}),t("el-input",{staticStyle:{width:"calc(50% - 5px)"},attrs:{placeholder:"请填写value",maxlength:"50","show-word-limit":""},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"item.value"}})],1)})),t("div",{staticClass:"addextendParamMapping",on:{click:function(t){return e.addextendParam(e.ruleForm.errorActionInfo.extendParam)}}},[e._v(" + 添加参数 ")])],2),t("el-form-item",{attrs:{label:"扩展参数映射",prop:"extendParamMapping"}},[e._l(e.ruleForm.errorActionInfo.extendParamMapping,(function(r,a){return t("div",{key:a+"item",staticStyle:{margin:"5px 0"}},[t("el-input",{staticStyle:{width:"calc(50% - 25px)"},attrs:{maxlength:"50","show-word-limit":"",placeholder:"请填写技能key"},model:{value:r.skillKey,callback:function(t){e.$set(r,"skillKey",t)},expression:"item.skillKey"}}),t("div",{staticStyle:{display:"inline-block",width:"50px","text-align":"center"}},[e._v("对应")]),t("el-input",{staticStyle:{width:"calc(50% - 25px)"},attrs:{maxlength:"50","show-word-limit":"",placeholder:"请填写事件key"},model:{value:r.eventKey,callback:function(t){e.$set(r,"eventKey",t)},expression:"item.eventKey"}})],1)})),t("div",{staticClass:"addextendParamMapping",on:{click:function(t){return e.addextendParamMapping(e.ruleForm.errorActionInfo.extendParamMapping)}}},[e._v(" + 添加参数 ")])],2)],1)],1):e._e()],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")]),t("el-button",{on:{click:function(t){return e.$emit("go-back")}}},[e._v("取消")])],1)],1)],1)},l=[],o=(r(57658),r(56414));const i={getSkill:{url:"/proactive_admin_api/scene/skill/get"},updateSkill:{url:"/proactive_admin_api/scene/skill/update",method:"post"},addSkill:{url:"/proactive_admin_api/scene/skill/add",method:"post"}};function n(e,t){const r=i[e].method||"get",a={method:r,url:`${i[e].url}`},l=i[e].isFile;return l&&(a.isFile=l),"post"===r?a.data=t:a.params=t,i[e].isAllData?(0,o.Z)(a).then((e=>e)):(0,o.Z)(a).then((({data:e})=>e))}var s={props:{row:{type:Object,default(){return{}}},mode:{type:String,default:""}},data(){return{ruleForm:{skillName:"",extendParam:[{key:"",value:""}],extendParamMapping:[{eventKey:"",skillKey:""}],extendParamThird:[{key:"",name:"",dataType:1}],errorActionFlag:0,startAction:"",appPkg:"",appVer:1},showAppPkg:!0,showAppVer:!0,rules:{skillName:[{required:!0,pattern:/^(?!\s+$).*/,message:"请输入技能名称"}],appPkg:[{required:!0,pattern:/^(?!\s+$).*/,message:"请输入应用包名",trigger:"blur"}],appVer:[{required:!0,message:"请输入应用版本号",trigger:"blur"},{pattern:/^[0-9]*$/,message:"只能输入数字",trigger:"blur"}],startAction:[{required:!0,message:"请选择启动动作",trigger:"change"}],startMethod:[{required:!0,message:"请选择启动方式"}],startParam:[{required:!0,pattern:/^(?!\s+$).*/,message:"请输入启动参数"}]}}},methods:{handleStartActionChange(e){100002===e&&(this.$set(this.ruleForm,"appPkg",""),this.$set(this.ruleForm,"appVer",""))},handleStartMethodChange(e){200001===e&&(this.$set(this.ruleForm,"appPkg",""),this.$set(this.ruleForm,"appVer",""))},handleErrorStartActionChange(e){if(100002===e){const{verCode:e,...t}=this.ruleForm.errorActionInfo;this.$set(this.ruleForm,"errorActionInfo",{...t,appPkg:"",appVer:""})}},handleErrorStartMethodChange(e){if(200001===e){const{verCode:e,...t}=this.ruleForm.errorActionInfo;this.$set(this.ruleForm,"errorActionInfo",{...t,appPkg:"",appVer:""})}},addErrorActionInfo(e){1===e?this.$set(this.ruleForm,"errorActionInfo",{appVer:1,extendParam:[{key:"",value:""}],extendParamMapping:[{eventKey:"",skillKey:""}]}):this.$set(this.ruleForm,"errorActionInfo",{})},addextendParam(e){e.push({key:"",value:""})},addextendParamMapping(e){e.push({eventKey:"",skillKey:""})},addextendParamThird(e){e.push({key:"",name:"",dataType:1})},submitForm(){this.$refs.ruleForm.validate((e=>{if(this.ruleForm.errorActionFlag)this.$refs.ruleForm2.validate((t=>{if(!e||!t)return!1;n("edit"===this.mode?"updateSkill":"addSkill",this.ruleForm).then((e=>{this.$emit("go-back",!0),this.$message({type:"success",message:"保存成功！"})}))}));else{if(!e)return!1;n("edit"===this.mode?"updateSkill":"addSkill",this.ruleForm).then((e=>{this.$emit("go-back",!0),this.$message({type:"success",message:"保存成功！"})}))}}))}},created(){"edit"===this.mode&&n("getSkill",{id:this.row.id}).then((e=>{this.ruleForm=e}))}},c=s,m=r(1001),u=(0,m.Z)(c,a,l,!1,null,"70db52b1",null),d=u.exports},97711:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",[e._v("暂无对应的页面组件")])},l=[],o={},i=o,n=r(1001),s=(0,n.Z)(i,a,l,!1,null,null,null),c=s.exports},83491:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"service-timing-wrapper"},[t("el-form",{ref:"timingForm",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[t("el-form-item",{attrs:{label:"对应服务",prop:"serviceId"}},[t("el-select",{attrs:{placeholder:"请选择对应服务"},model:{value:e.form.serviceId,callback:function(t){e.$set(e.form,"serviceId",t)},expression:"form.serviceId"}},[e._l(e.serviceList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.serviceName,value:Number(e.id)}})})),t("el-option",{attrs:{label:"区域二",value:"beijing"}})],2)],1),t("el-form-item",{attrs:{label:"时机名称",prop:"name"}},[t("el-input",{staticStyle:{width:"500px"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",[e.ruleTagsList.length>0?t("TagsRule",{ref:"tagRule",attrs:{tagList:e.ruleTagsList,ruleJson:e.form.ruleJsonObj,serviceId:0,parentIndex:0},on:{"update:ruleJson":function(t){return e.$set(e.form,"ruleJsonObj",t)},"update:rule-json":function(t){return e.$set(e.form,"ruleJsonObj",t)}}}):e._e()],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveForm}},[e._v("保存")])],1)],1)],1)},l=[],o=r(23304),i=r(66770),n=r(56414);function s(e){return(0,n.Z)({method:"post",url:"proactive_admin_api/interactify/moment/add",data:e})}function c(e){return(0,n.Z)({method:"get",url:"proactive_admin_api/interactify/moment/get",params:e})}function m(e){return(0,n.Z)({method:"post",url:"proactive_admin_api/interactify/moment/update",data:e})}var u=r(97440),d={props:{mode:{type:String},row:{type:Object,default:()=>({})}},components:{TagsRule:u.Z},provide(){return{serviceId:this.form.serviceId}},data(){return{ruleTagsList:[],rules:{name:[{required:!0,message:"请输入时机名称",trigger:["blur","change"]}]},rowId:"",form:{name:"",serviceId:"",ruleJson:JSON.stringify({rules:[],condition:"AND"}),ruleJsonObj:{rules:[],condition:"AND"}},serviceList:[]}},computed:{},watch:{},methods:{async getRuleTagsList(){try{const e=await(0,i.G0)();1e3===e.code&&(this.ruleTagsList=e.data.map((e=>({...e,ruleJson:e.ruleJson?JSON.parse(e.ruleJson):{}}))))}catch(e){console.error("getRuleTagsList error: ",e)}},async getServiceList(){try{const e=await(0,o.lo)({page:1,pageSize:1e3});1e3===e.code&&(this.serviceList=e.data)}catch(e){console.error("获取服务列表失败",e)}},saveForm(){this.$refs.timingForm.validate((e=>!!e&&(this.$refs.tagRule&&(Array.isArray(this.$refs.tagRule)?this.$refs.tagRule.map((e=>{e.transformSaveRules()})):this.$refs.tagRule.transformSaveRules()),this.form.ruleJson=this.form.ruleJsonObj?JSON.stringify(this.form.ruleJsonObj):"{}","add"===this.mode?this.addServiceTiming():"edit"===this.mode&&this.editServiceTiming(),!0)))},async addServiceTiming(){try{const e=await s(this.form);1e3===e.code&&(this.$message({type:"success",message:"添加成功"}),this.$emit("go-back",!0))}catch(e){console.error("addServiceTiming error: ",e)}},async editServiceTiming(){try{const e=await m({...this.form,id:this.row.id});1e3===e.code&&(this.$emit("go-back",!0),this.$message({type:"success",message:"修改成功"}))}catch(e){console.error("editServiceTiming error: ",e)}},async refill(){if("edit"===this.mode)try{const e=await c({id:this.row.id});1e3===e.code&&(this.form=e.data,e.data.ruleJson?this.$set(this.form,"ruleJsonObj",JSON.parse(e.data.ruleJson)):this.$set(this.form,"ruleJsonObj",{rules:[],condition:"AND"}))}catch(e){console.error("getServiceTimingDetail error: ",e)}}},mounted(){},async created(){this.getServiceList(),await this.getRuleTagsList(),this.refill()}},p=d,h=r(1001),f=(0,h.Z)(p,a,l,!1,null,"a73376e6",null),g=f.exports},30019:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var a=function(){var e=this,t=e._self._c;return e.menuDetail?t("LowcodeEngine",{attrs:{"menu-id":e.menuId,menuDetail:e.menuDetail,"fetch-method":e.commonFetch,_headers:e.headers,"page-detail-method":e.getLowerDetail,"handle-resource":e.handleResource}}):e._e()},l=[],o=r(51755),i=r(56414);function n(e){return(0,i.Z)({method:"get",url:"auth/menu/detail",params:e})}function s(e){return(0,i.Z)({method:"get",url:"admin/pageConfiguation/detail",params:e})}const c=r(72386),m={};c.keys().forEach((e=>{m[e.replace(/(^\.\/|\.vue$)/g,"")]=c(e).default}));var u=m;const d=r(9614),p={};d.keys().forEach((e=>{p[e.replace(/(^\.\/|\.vue$)/g,"")]=d(e).default}));var h=p,f={exampleTodo(e){console.log("example to do ",e)}},g={exampleString(e){return(t,{row:r})=>t("span",{},r[e])}},v={props:["menuId"],data(){return{handleResource:{pages:u,dialogs:h,todo:f,renderMethods:g}}}},k={name:"lowerEngine",props:["menuId"],mixins:[v],components:{LowcodeEngine:o.ZW},data(){return{commonFetch:i.Z,getMenusDetail:n,getLowerDetail:s,menuDetail:"",headers:()=>this.$store.getters.httpHeaders}},created(){this.getMenusDetail({id:this.menuId}).then((e=>{this.menuDetail=e.data}))}},x=k,y=r(1001),b=(0,y.Z)(x,a,l,!1,null,null,null),F=b.exports},9614:function(e,t,r){var a={"./AAADialog.vue":36852,"./skillEditDialog.vue":43647};function l(e){var t=o(e);return r(t)}function o(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}l.keys=function(){return Object.keys(a)},l.resolve=o,e.exports=l,l.id=9614},72386:function(e,t,r){var a={"./AAAPage.vue":97711,"./ServiceTimingOperatePage.vue":83491};function l(e){var t=o(e);return r(t)}function o(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}l.keys=function(){return Object.keys(a)},l.resolve=o,e.exports=l,l.id=72386}}]);
//# sourceMappingURL=LowcodeEngine.d1215939.js.map